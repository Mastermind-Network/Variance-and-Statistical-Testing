---
title: "Variance R Code"
author: "Patrick Windeit"
date: "2025-09-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Data (reaction times in seconds)
female <- c(
  0.588, 0.403, 0.293, 0.377, 0.613, 0.377, 0.391,
  0.367, 0.442, 0.274, 0.434, 0.403, 0.636, 0.481,
  0.652, 0.443, 0.380, 0.646, 0.340, 0.617
)

male <- c(
  0.375, 0.477, 0.374, 0.465, 0.402, 0.337, 0.655,
  0.488, 0.427, 0.373, 0.224, 0.654, 0.563, 0.405, 0.256
)
```
```{r}
# Calculate key values
nF  <- length(female); dfF <- nF - 1
nM  <- length(male);   dfM <- nM - 1

s2F <- var(female)
s2M <- var(male)  

round(c(nF = nF, nM = nM, s2F = s2F, s2M = s2M), 4)
```


## Problem 1: 95 % C.I for Female Variance:
We want a 95% confidence interval for the variance of female reaction times.
```{r}
alpha <- 0.05
chi_lower <- qchisq(1 - alpha/2,dfF)
chi_upper <- qchisq(alpha/2,dfF)

c(chi_lower, chi_upper)

CI_var_F <- c((dfF * s2F) / chi_lower, (dfF * s2F) / chi_upper)
round(CI_var_F, 5)

```
**Interpretation:**
**The 95% confidence interval** for the female variance was **0.00869** to **0.03205**. This means we are 95% confident that the true variance of female reaction times is within this range. Based on the interval this means female reaction times appear to be consistent.


## Problem 2: Male variance:
We test if the male variance is different from 0.02 sec².
**Null Hypothesis (\(H_0\))**  \( H_0: \sigma^2 = 0.02 \)
**Alternative Hypothesis (\(H_1\))**  \( H_1: \sigma^2 \neq 0.02 \)
```{r}
sigma0_sq <- 0.02

chi_stat <- dfM * s2M / sigma0_sq
crit_lo  <- qchisq(alpha/2,     dfM)
crit_hi  <- qchisq(1 - alpha/2, dfM)

p_left  <- pchisq(chi_stat, dfM)
p_right <- 1 - pchisq(chi_stat, dfM)
p_val_two <- 2 * min(p_left, p_right)

round(c(chi_stat = chi_stat, crit_lo = crit_lo, crit_hi = crit_hi, p_val = p_val_two), 4)
```
**Interpretation:**
The test statistic for male variance was **10.8718** with a p-value of **0.6078**. Since the p-value is much greater than 0.05 we fail to reject the null hypothesis. The male variance **is not significantly different** from 0.02 seconds squared.


## Problem 3: Ratio of variances:
We compare the variability by building a CI for the ratio of variances.
```{r}
s2_top <- max(s2F, s2M)
s2_bot <- min(s2F, s2M)
df_top <- ifelse(s2F >= s2M, dfF, dfM)
df_bot <- ifelse(s2F >= s2M, dfM, dfF)

R <- s2_top / s2_bot
c(s2_top = s2_top, df_top = df_top, s2_bot = s2_bot, df_bot = df_bot, R = R)

F_u <- qf(1 - alpha/2, df_top, df_bot)
F_l <- qf(1 - alpha/2, df_bot, df_top)
c(F_u, F_l)

CI_ratio <- c(R / F_l, R * F_u)
round(CI_ratio, 4)
```
**Interpretation:**
The 95% confidence interval for the ratio of female to male variances was **0.3613** to **2.7360**. So yes the interval includes 1. This shows that the males and females have similar variability in reaction times.


## Problem 4: F-test for equal variances:
This test directly checks if the two variances are the same.
```{r}
F_stat <- R

crit_upper <- qf(1 - alpha/2, df_top, df_bot)
crit_lower <- qf(1 - alpha/2, df_bot, df_top)
c(F_stat, crit_upper, crit_lower)


p_left_F  <- pf(F_stat, df_top, df_bot)
p_right_F <- pf(F_stat, df_top, df_bot, lower.tail=FALSE)
p_two <- 2 * min(p_left_F, p_right_F)

round(c(F_stat = F_stat, crit_lower = crit_lower, crit_upper = crit_upper, p_two = p_two), 4)

crit_upper2 <- qf(1 - alpha/2, 24, 21); crit_upper2
crit_lower2 <- qf(1 - alpha/2, 21, 24); crit_lower2
```
**Interpretation:**
The F-test gave a statistic of **1.0336** with a p-value of **0.9276**. Since the p-value is greater than 0.05, **we fail to reject**. The male group has more variability but only by a tiny bit so I would conclude that there is no significant difference in female and male reaction times.


**Conclusion:**
The 95% CI for female variance was **0.00869** to **0.03205**. This shows consistent female times. The male variance test gave a p-value of **0.6078**, so it is **not significantly different** from **0.02 sec²**. The confidence interval for the variance ratio contains 1. This means the two groups could have similar variability. The F-test p-value was **0.9276** leading us to fail to reject. This helps us conclude that there is **no meaningful difference** in variances between male and female reaction times.
